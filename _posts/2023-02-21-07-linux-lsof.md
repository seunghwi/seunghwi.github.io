---
layout: single
title:  "linux lsof, find"
categories: "Linux"
tag: ["Linux", "lsof","find","exec"]
toc: true
author_profile: true
sidebar:
    nav: "docs"
---

## lsof
"List Open Files"의 약자로, 리눅스나 유닉스 시스템에서 열려있는 파일들을 리스트로 보여주는 명령어입니다. 현재 시스템에서 열려있는 파일들의 상세 정보를 확인할 수 있습니다.

다양한 옵션을 사용하여 특정 프로세스나 파일에 대한 정보를 확인할 수 있습니다. 명령어 실행 시 사용할 수 있는 일부 주요 옵션은 다음과 같습니다.

- -i: 인터넷 주소나 포트에 대한 정보를 출력합니다.
- -n: 호스트 이름을 숫자로 표시합니다.
- -c: 지정한 프로세스명에 대한 정보만 출력합니다.
- -p: 지정한 PID에 대한 정보만 출력합니다.
- -u: 지정한 사용자에 대한 정보만 출력합니다.
- -t: 터미널에 대한 정보만 출력합니다.
- -f: 파일 식별자(file descriptor)에 대한 정보를 출력합니다.
- -d: 지정한 파일이 열려있는 프로세스에 대한 정보만 출력합니다.

예를 들어, 다음 명령어는 httpd 프로세스가 열어놓은 파일들의 목록을 출력합니다.
```bash
lsof -c httpd
```

시스템 관리자나 개발자들이 파일 락(lock)을 확인하거나, 파일 시스템 문제를 분석하거나, 포트 충돌 등의 문제를 해결하는 데에 유용하게 사용될 수 있습니다.


## find
리눅스나 유닉스 시스템에서 파일 검색에 사용되는 명령어입니다. find 명령어를 사용하면, 특정 조건에 맞는 파일을 검색하여 출력할 수 있습니다. find 명령어는 파일 이름, 파일 크기, 파일 소유자, 수정 날짜 등 다양한 속성을 기준으로 파일을 검색할 수 있습니다.

find 명령어의 기본 구문은 다음과 같습니다.
```
find [경로] [옵션] [조건]
```

- \[경로]: 파일 검색을 시작할 디렉토리 경로를 지정합니다. 기본값은 현재 디렉토리(.)입니다.
- \[옵션]: 검색 옵션을 지정합니다. 주요 옵션으로는 -name, -type, -size, -mtime 등이 있습니다.
- \[조건]: 검색 조건을 지정합니다. 검색 조건은 옵션에 따라 다릅니다.

주요 옵션에 대해 간략히 설명해보겠습니다.

- -name: 파일 이름을 기준으로 검색합니다. 예를 들어, -name "*.txt"와 같이 사용하면, 현재 디렉토리에서 확장자가 txt인 파일을 검색할 수 있습니다.
- -type: 파일의 타입에 따라 검색합니다. 예를 들어, -type f와 같이 사용하면, 파일만 검색할 수 있습니다.
- -size: 파일 크기에 따라 검색합니다. 예를 들어, -size +1M와 같이 사용하면, 1메가바이트보다 큰 파일을 검색할 수 있습니다.
- -mtime: 파일 수정 시간에 따라 검색합니다. 예를 들어, -mtime -7과 같이 사용하면, 최근 7일 이내에 수정된 파일을 검색할 수 있습니다.


위의 옵션과 조건을 조합하여, 특정한 검색을 수행할 수 있습니다. 예를 들어, 다음 명령어는 현재 디렉토리에서 이름이 test.txt인 파일을 검색합니다.
```
find . -name "test.txt"
```
명령어는 파일 검색 뿐만 아니라, 디렉토리 구조에서 특정 파일이나 디렉토리를 삭제하거나, 파일 권한을 변경하는 등의 작업에도 유용하게 사용됩니다.

### find -exec
find 명령어에는 -exec 옵션이 있습니다. 이 옵션을 사용하면 find 명령어로 검색된 파일에 대해, 지정한 명령어를 실행할 수 있습니다. -exec 옵션의 구문은 다음과 같습니다.

```
find [경로] [조건] -exec [명령어] {} \;
```

- \[경로]: 파일 검색을 시작할 디렉토리 경로를 지정합니다.
- \[조건]: 검색 조건을 지정합니다.
- \[명령어]: 실행할 명령어를 지정합니다. 중괄호({})로 검색된 파일 이름을 참조할 수 있습니다.
- \\;: 명령어 실행의 끝을 나타내는 표시입니다. 세미콜론(;)과 백슬래시()를 사용하여 표시할 수 있습니다.


이 옵션을 사용하면, 검색된 파일에 대해 지정한 명령어를 실행할 수 있습니다. 이 때 중괄호({})를 사용하여 파일 이름을 참조할 수 있습니다. 예를 들어, 다음 명령어는 현재 디렉토리에서 확장자가 txt인 파일을 검색하고, 각 파일을 삭제합니다.

```
find . -name "*.txt" -exec rm {} \;
```

이 옵션을 사용하여 파일을 삭제하는 작업 외에도, 파일의 권한을 변경하거나 이동하는 등의 다양한 작업을 수행할 수 있습니다. find 명령어와 -exec 옵션을 조합하여, 복잡한 파일 작업을 자동화할 수 있습니다.

